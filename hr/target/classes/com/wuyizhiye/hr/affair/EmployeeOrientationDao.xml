<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.wuyizhiye.hr.affair.dao.EmployeeOrientationDao">
	<insert id="copyToPerson" parameterType="java.util.Map">
			insert into T_BD_PERSON
			  (FID,
			   FNAME,
			   FSIMPLEPINYIN,
			   FNUMBER,
			   FDESCRIPTION,
			   FCREATETIME,
			   FKCREATORID,
			   FLASTUPDATETIME,
			   FKUPDATORID,
			   FKCONTROLUNITID,
			   FKORGID,
			   FOLDNAME,
			   FIDCARD,
			   FBIRTHDAY,
			   FSEX,
			   FWORKPHONE,
			   FPHONE,
			   FSHORTNUMBER,
			   FEMAIL,
			   FCRASHCONTRACT,
			   FCONTRACTPHONE,
			   FPHOTO,
			   FUSERNAME,
			   FPASSWORD,
			   FSTATUS,
			   FNOWLIVEPLACE,
			   FFAMILYADDRESS,
			   FFAMILYTEL,
			   FFOLK,
			   FWEDSTATUS,
			   FWORKYEAR,
			   FINTEREST,
			   FRECRUITMETHOD,
			   FRECRUITREMARK,
			   FRELATION,
			   FPERSONSTATUS,
			   FJOBSTATUS,
			   FLEAVEDATE,
			   FINNERDATE,
			   FBANK,
			   FBANKNUMBER,
			   FCOMPUTERNUMBER,
			   FFUNDNUMBER,
			   FHIGHESTEDUCATION,
			   FKINTRODUCERID,
			   FHOUSEHOLD,
			   FNATIVEPLACE,
			   FPERSONALREMARK,
			   FPROBATIONPERIOD,
			   FCARDTYPE,
			   FQQ)  (select   FKAPPLYPERSONID,
			   FNAME,
			   FSIMPLEPINYIN,
			   FNUMBER,
			   FDESCRIPTION,
			   FCREATETIME,
			   FKCREATORID,
			   FLASTUPDATETIME,
			   FKUPDATORID,
			   FKCONTROLUNITID,
			   FKORGID,
			   FOLDNAME,
			   FIDCARD,
			   FBIRTHDAY,
			   FSEX,
			   FWORKPHONE,
			   FPHONE,
			   FSHORTNUMBER,
			   FEMAIL,
			   FCRASHCONTRACT,
			   FCONTRACTPHONE,
			   FPHOTO,
			   FUSERNAME,
			   FPASSWORD,
			   FSTATUS,
			   FNOWLIVEPLACE,
			   FFAMILYADDRESS,
			   FFAMILYTEL,
			   FFOLK,
			   FWEDSTATUS,
			   FWORKYEAR,
			   FINTEREST,
			   FRECRUITMETHOD,
			   FRECRUITREMARK,
			   FRELATION,
			   FPERSONSTATUS,
			   FJOBSTATUS,
			   FLEAVEDATE,
			   FINNERDATE,
			   FBANK,
			   FBANKNUMBER,
			   FCOMPUTERNUMBER,
			   FFUNDNUMBER,
			   FHIGHESTEDUCATION,
			   FKINTRODUCERID,
			   FHOUSEHOLD,
			   FNATIVEPLACE,
			   FPERSONALREMARK,
			   FPROBATIONPERIOD,
			   FCARDTYPE,
			   FQQ from t_hr_employeeorientation where FID =#{FID})
	</insert>
	<insert id="insert" parameterType="com.wuyizhiye.hr.affair.model.EmployeeOrientation">
			INSERT INTO T_HR_EMPLOYEEORIENTATION
		(
			FID,
			FNAME,
			FNUMBER,
			FSIMPLEPINYIN,
			FDESCRIPTION,
			FCREATETIME,
			FKCREATORID,
			FLASTUPDATETIME,
			FKUPDATORID,
			FKCONTROLUNITID,
			FKORGID,
			FSUBMITDATE,
			FAUDITDATE,
			FPROCESSINSTANCE,
			FOLDNAME,
			FIDCARD,
			FBIRTHDAY,
			FSEX,
			FPHONE,
			FWORKPHONE,
			FSHORTNUMBER,
			FEMAIL,
			FCRASHCONTRACT,
			FCONTRACTPHONE,
			FPHOTO,
			FUSERNAME,
			FPASSWORD,
			FSTATUS,
			FKPERSONPOSITIONID,
			FQQ,
			FHOUSEHOLD,
			FNOWLIVEPLACE,
			FNATIVEPLACE,
			FFAMILYADDRESS,
			FFAMILYTEL,
			FFOLK,
			FWEDSTATUS,
			FWORKYEAR,
			FINTEREST,
			FRECRUITMETHOD,
			FRECRUITREMARK,
			FKINTRODUCERID,
			FRELATION,
			FPERSONSTATUS,
			FJOBSTATUS,
			FLEAVEDATE,
			FINNERDATE,
			FBANK,
			FBANKNUMBER,
			FCOMPUTERNUMBER,
			FFUNDNUMBER,
			FHIGHESTEDUCATION,
			FPERSONALREMARK,
			FFANSCOUNT,
			FPOSITIONNAME,
			FbillStatu,
			FKMAINPOSITIONORGID,
			FKMAINPOSITIONID,
			FKMAINJOBLEVELID,
			FTITLE,
			fbillNumber,
			FKAPPLYPERSONID,
			FPROBATIONPERIOD,
			FCARDTYPE,
			FPREFIRSTMONTH,
		    FPRETWOMONTH,
		    FPRETHREEMONTH,
		    FRESULTSNOTE,
		    FKREFERRERID,
		    FISEFFECTIVE
		) VALUES
		(
			#{id,jdbcType=VARCHAR},
			#{name,jdbcType=VARCHAR},
			#{number,jdbcType=VARCHAR},
			#{simplePinyin,jdbcType=VARCHAR},
			#{description,jdbcType=VARCHAR},
			#{createTime,jdbcType=TIMESTAMP},
			#{creator.id,jdbcType=VARCHAR},
			#{lastUpdateTime,jdbcType=TIMESTAMP},
			#{updator.id,jdbcType=VARCHAR},
			#{controlUnit.id,jdbcType=VARCHAR},
			#{org.id,jdbcType=VARCHAR},
			#{submitDate,jdbcType=TIMESTAMP},
			#{auditDate,jdbcType=TIMESTAMP},
			#{processInstance,jdbcType=VARCHAR},
			#{oldName,jdbcType=VARCHAR},
			#{idCard,jdbcType=VARCHAR},
			#{birthday,jdbcType=TIMESTAMP},
			#{sex,jdbcType=VARCHAR},
			#{phone,jdbcType=VARCHAR},
			#{workPhone,jdbcType=VARCHAR},
			#{shortNumber,jdbcType=VARCHAR},
			#{email,jdbcType=VARCHAR},
			#{crashContract,jdbcType=VARCHAR},
			#{contractPhone,jdbcType=VARCHAR},
			#{photo,jdbcType=VARCHAR},
			#{userName,jdbcType=VARCHAR},
			#{password,jdbcType=VARCHAR},
			#{status,jdbcType=VARCHAR},
			#{personPosition.id,jdbcType=VARCHAR},
			#{qq,jdbcType=VARCHAR},
			#{household,jdbcType=VARCHAR},
			#{nowLivePlace,jdbcType=VARCHAR},
			#{nativePlace.id,jdbcType=VARCHAR},
			#{familyAddress,jdbcType=VARCHAR},
			#{familyTel,jdbcType=VARCHAR},
			#{folk.id,jdbcType=VARCHAR},
			#{wedStatus,jdbcType=VARCHAR},
			#{workYear,jdbcType=VARCHAR},
			#{interest,jdbcType=VARCHAR},
			#{recruitmethod,jdbcType=VARCHAR},
			#{recruitRemark,jdbcType=VARCHAR},
			#{introducer.id,jdbcType=VARCHAR},
			#{relation,jdbcType=VARCHAR},
			#{personStatus,jdbcType=VARCHAR},
			#{jobStatus.id,jdbcType=VARCHAR},
			#{leaveDate,jdbcType=TIMESTAMP},
			#{innerDate,jdbcType=TIMESTAMP},
			#{bank,jdbcType=VARCHAR},
			#{bankNumber,jdbcType=VARCHAR},
			#{computerNumber,jdbcType=VARCHAR},
			#{fundNumber,jdbcType=VARCHAR},
			#{highestEducation,jdbcType=VARCHAR},
			#{personalRemark,jdbcType=VARCHAR},
			#{fansCount,jdbcType=INTEGER},
			#{positionName,jdbcType=VARCHAR},
			#{billStatu,jdbcType=VARCHAR},
			#{mainPositionOrg.id,jdbcType=VARCHAR},
			#{mainPosition.id,jdbcType=VARCHAR},
			#{mainJobLevel.id,jdbcType=VARCHAR},
			#{title,jdbcType=VARCHAR},
			#{billNumber,jdbcType=VARCHAR},
			#{applyPerson.id,jdbcType=VARCHAR},
			#{probationPeriod,jdbcType=INTEGER},
			#{cardType,jdbcType=VARCHAR},
			#{preFirstMonth,jdbcType=VARCHAR},
			#{preTwoMonth,jdbcType=VARCHAR},
			#{preThreeMonth,jdbcType=VARCHAR},
			#{resultsNote,jdbcType=VARCHAR},
			#{referrer.id,jdbcType=VARCHAR},
			#{isEffective,jdbcType=INTEGER}
		)

	</insert>
	<update id="update" parameterType="com.wuyizhiye.hr.affair.model.EmployeeOrientation">
			UPDATE t_hr_EmployeeOrientation
		<set>
			FID = #{id,jdbcType=VARCHAR},
			FNAME = #{name,jdbcType=VARCHAR},
			FNUMBER = #{number,jdbcType=VARCHAR},
			FSIMPLEPINYIN = #{simplePinyin,jdbcType=VARCHAR},
			FDESCRIPTION = #{description,jdbcType=VARCHAR},
			FCREATETIME = #{createTime,jdbcType=TIMESTAMP},
			FKCREATORID = #{creator.id,jdbcType=VARCHAR},
			FLASTUPDATETIME = #{lastUpdateTime,jdbcType=TIMESTAMP},
			FKUPDATORID = #{updator.id,jdbcType=VARCHAR},
			FKCONTROLUNITID = #{controlUnit.id,jdbcType=VARCHAR},
			FKORGID = #{org.id,jdbcType=VARCHAR},
			FSUBMITDATE = #{submitDate,jdbcType=TIMESTAMP},
			FAUDITDATE = #{auditDate,jdbcType=TIMESTAMP},
			FPROCESSINSTANCE = #{processInstance,jdbcType=VARCHAR},
			FOLDNAME = #{oldName,jdbcType=VARCHAR},
			FIDCARD = #{idCard,jdbcType=VARCHAR},
			FBIRTHDAY = #{birthday,jdbcType=TIMESTAMP},
			FSEX = #{sex,jdbcType=VARCHAR},
			FPHONE = #{phone,jdbcType=VARCHAR},
			FWORKPHONE = #{workPhone,jdbcType=VARCHAR},
			FSHORTNUMBER = #{shortNumber,jdbcType=VARCHAR},
			FEMAIL = #{email,jdbcType=VARCHAR},
			FCRASHCONTRACT = #{crashContract,jdbcType=VARCHAR},
			FCONTRACTPHONE = #{contractPhone,jdbcType=VARCHAR},
			FPHOTO = #{photo,jdbcType=VARCHAR},
			FUSERNAME = #{userName,jdbcType=VARCHAR},
			FPASSWORD = #{password,jdbcType=VARCHAR},
			FSTATUS = #{status,jdbcType=VARCHAR},
			FKPERSONPOSITIONID = #{personPosition.id,jdbcType=VARCHAR},
			FQQ = #{qq,jdbcType=VARCHAR},
			FHOUSEHOLD = #{household,jdbcType=VARCHAR},
			FNOWLIVEPLACE = #{nowLivePlace,jdbcType=VARCHAR},
			FNATIVEPLACE = #{nativePlace.id,jdbcType=VARCHAR},
			FFAMILYADDRESS = #{familyAddress,jdbcType=VARCHAR},
			FFAMILYTEL = #{familyTel,jdbcType=VARCHAR},
			FFOLK = #{folk.id,jdbcType=VARCHAR},
			FWEDSTATUS = #{wedStatus,jdbcType=VARCHAR},
			FWORKYEAR = #{workYear,jdbcType=VARCHAR},
			FINTEREST = #{interest,jdbcType=VARCHAR},
			FRECRUITMETHOD = #{recruitmethod,jdbcType=VARCHAR},
			FRECRUITREMARK = #{recruitRemark,jdbcType=VARCHAR},
			FKINTRODUCERID = #{introducer.id,jdbcType=VARCHAR},
			FRELATION = #{relation,jdbcType=VARCHAR},
			FPERSONSTATUS = #{personStatus,jdbcType=VARCHAR},
			FJOBSTATUS = #{jobStatus.id,jdbcType=VARCHAR},
			FLEAVEDATE = #{leaveDate,jdbcType=TIMESTAMP},
			FINNERDATE = #{innerDate,jdbcType=TIMESTAMP},
			FBANK = #{bank,jdbcType=VARCHAR},
			FBANKNUMBER = #{bankNumber,jdbcType=VARCHAR},
			FCOMPUTERNUMBER = #{computerNumber,jdbcType=VARCHAR},
			FFUNDNUMBER = #{fundNumber,jdbcType=VARCHAR},
			FHIGHESTEDUCATION = #{highestEducation,jdbcType=VARCHAR},
			FPERSONALREMARK = #{personalRemark,jdbcType=VARCHAR},
			FFANSCOUNT = #{fansCount,jdbcType=INTEGER},
			FPOSITIONNAME = #{positionName,jdbcType=VARCHAR},
			FbillStatu = #{billStatu,jdbcType=VARCHAR},
			FKMAINPOSITIONORGID = #{mainPositionOrg.id,jdbcType=VARCHAR},
			FKMAINPOSITIONID = #{mainPosition.id,jdbcType=VARCHAR},
			FKMAINJOBLEVELID = #{mainJobLevel.id,jdbcType=VARCHAR},
			FTITLE = #{title,jdbcType=VARCHAR},
			FKAPPLYPERSONID = #{applyPerson.id,jdbcType=VARCHAR},
			FPROBATIONPERIOD = #{probationPeriod,jdbcType=INTEGER},
			FCARDTYPE = #{cardType,jdbcType=VARCHAR},
			FPREFIRSTMONTH = #{preFirstMonth,jdbcType=VARCHAR},
		    FPRETWOMONTH = #{preTwoMonth,jdbcType=VARCHAR},
		    FPRETHREEMONTH = #{preThreeMonth,jdbcType=VARCHAR},
		    FRESULTSNOTE = #{resultsNote,jdbcType=VARCHAR},
		    FKREFERRERID = #{referrer.id,jdbcType=VARCHAR},
		    FISEFFECTIVE = #{isEffective,jdbcType=INTEGER}
		</set>
		WHERE FID = #{id}

	</update>
	<delete id="delete" parameterType="String">
			DELETE FROM t_hr_EmployeeOrientation WHERE FID = #{id}

	</delete>
	<select id="getById" parameterType="String" resultType="com.wuyizhiye.hr.affair.model.EmployeeOrientation">
			SELECT 
			D.FID AS "id",
			D.FNAME AS "name",
			D.FNUMBER AS "number",
			D.FSIMPLEPINYIN AS "simplePinyin",
			D.FDESCRIPTION AS "description",
			D.FCREATETIME AS "createTime",
			D.FKCREATORID AS "creator.id",
			D.FLASTUPDATETIME AS "lastUpdateTime",
			D.FKUPDATORID AS "updator.id",
			D.FKCONTROLUNITID AS "controlUnit.id",
			D.FKORGID AS "org.id",
			D.FSUBMITDATE AS "submitDate",
			D.FAUDITDATE AS "auditDate",
			D.FPROCESSINSTANCE AS "processInstance",
			D.FOLDNAME AS "oldName",
			D.FIDCARD AS "idCard",
			D.FBIRTHDAY AS "birthday",
			D.FSEX AS "sex",
			D.FPHONE AS "phone",
			D.FWORKPHONE AS "workPhone",
			D.FSHORTNUMBER AS "shortNumber",
			D.FEMAIL AS "email",
			D.FCRASHCONTRACT AS "crashContract",
			D.FCONTRACTPHONE AS "contractPhone",
			D.FPHOTO AS "photo",
			D.FUSERNAME AS "userName",
			D.FPASSWORD AS "password",
			D.FSTATUS AS "status",
			D.FKPERSONPOSITIONID AS "personPosition.id",
			D.FQQ AS "qq",
			D.FHOUSEHOLD AS "household",
			D.FNOWLIVEPLACE AS "nowLivePlace",
			D.FNATIVEPLACE AS "nativePlace.id",
			B1.FNAME AS "nativePlace.name",
			B2.FNAME AS "folk.name",
			D.FFAMILYADDRESS AS "familyAddress",
			D.FFAMILYTEL AS "familyTel",
			D.FFOLK AS "folk.id",
			D.FWEDSTATUS AS "wedStatus",
			D.FWORKYEAR AS "workYear",
			D.FINTEREST AS "interest",
			D.FRECRUITMETHOD AS "recruitmethod",
			D.FRECRUITREMARK AS "recruitRemark",
			D.FKINTRODUCERID AS "introducer.id",
			D.FRELATION AS "relation",
			D.FPERSONSTATUS AS "personStatus",
			D.FJOBSTATUS AS "jobStatus.id",
			B.FNAME AS "jobStatus.name",
			D.FLEAVEDATE AS "leaveDate",
			D.FINNERDATE AS "innerDate",
			D.FBANK AS "bank",
			D.FBANKNUMBER AS "bankNumber",
			D.FCOMPUTERNUMBER AS "computerNumber",
			D.FFUNDNUMBER AS "fundNumber",
			D.FHIGHESTEDUCATION AS "highestEducation",
			D.FPERSONALREMARK AS "personalRemark",
			D.FFANSCOUNT AS "fansCount",
			D.FPOSITIONNAME AS "positionName",
			D.FbillStatu as "billStatu",
			D.FKMAINPOSITIONORGID AS "mainPositionOrg.id",
			D.FKMAINPOSITIONID AS "mainPosition.id",
			D.FKMAINJOBLEVELID AS "mainJobLevel.id",
			p.fname as "mainPosition.name",
			D.FTITLE AS "title",
			D.fbillNumber as "billNumber",
			o.fname as "mainPositionOrg.name",
			j.fname as "mainJobLevel.name",
			CREATOR.FNAME AS "createName",
			CREATORPOSITION.FNAME AS "createPositionName" ,
			CREATORORG.FNAME AS "createOrgName",
			D.FKAPPLYPERSONID as "applyPerson.id" ,
			D.FCARDTYPE AS "cardType",
			D.FPROBATIONPERIOD as "probationPeriod" ,
			D.FPREFIRSTMONTH as "preFirstMonth",
		    D.FPRETWOMONTH as "preTwoMonth",
		    D.FPRETHREEMONTH as "preThreeMonth",
		    D.FRESULTSNOTE as "resultsNote",
		    D.FKREFERRERID AS "referrer.id",
		    RP.FNAME AS "referrer.name",
        	JB.FNAME AS "applyJoblevel.job.name",
        	D.FISEFFECTIVE AS "isEffective"
        	
		FROM t_hr_EmployeeOrientation D
		left join T_BD_POSITION P ON D.FKMAINPOSITIONID  = P.FID
		LEFT JOIN T_BD_ORG O ON D.FKMAINPOSITIONORGID = O.FID
		LEFT JOIN T_BD_JOBLEVEL J ON J.FID = D.FKMAINJOBLEVELID
		LEFT JOIN T_BD_JOB JB ON J.FKJOBID=JB.FID
		LEFT JOIN T_BD_PERSON CREATOR ON CREATOR.FID = D.FKCREATORID
		LEFT JOIN (SELECT * FROM T_BD_PERSONPOSITION WHERE FPRIMARY = 1) CREATORPP ON CREATORPP.FKPERSONID = D.FKCREATORID
		LEFT JOIN T_BD_POSITION CREATORPOSITION ON CREATORPOSITION.FID = CREATORPP.FKPOSITIONID
		LEFT JOIN T_BD_ORG CREATORORG ON CREATORORG.FID = CREATORPOSITION.FKBELONGORGID 
		LEFT JOIN T_BD_BASICDATA B ON D.FJOBSTATUS = B.FID
		LEFT JOIN T_BD_BASICDATA B1 ON D.FNATIVEPLACE = B1.FID
		LEFT JOIN T_BD_BASICDATA B2 ON D.FFOLK = B2.FID
		LEFT JOIN T_BD_PERSON RP ON RP.FID=D.FKREFERRERID
		WHERE D.FID = #{id}

	</select>
	
	
	<select id="select" parameterType="java.util.Map" resultType="com.wuyizhiye.hr.affair.model.EmployeeOrientation">
			SELECT 
			D.FID AS "id",
			D.FNAME AS "name",
			D.FNUMBER AS "number",
			D.FSIMPLEPINYIN AS "simplePinyin",
			D.FDESCRIPTION AS "description",
			D.FCREATETIME AS "createTime",
			D.FKCREATORID AS "creator.id",
			D.FLASTUPDATETIME AS "lastUpdateTime",
			D.FKUPDATORID AS "updator.id",
			D.FKCONTROLUNITID AS "controlUnit.id",
			D.FKORGID AS "org.id",
			D.FSUBMITDATE AS "submitDate",
			D.FAUDITDATE AS "auditDate",
			D.FPROCESSINSTANCE AS "processInstance",
			D.FOLDNAME AS "oldName",
			D.FIDCARD AS "idCard",
			D.FBIRTHDAY AS "birthday",
			D.FSEX AS "sex",
			D.FPHONE AS "phone",
			D.FWORKPHONE AS "workPhone",
			D.FSHORTNUMBER AS "shortNumber",
			D.FEMAIL AS "email",
			D.FCRASHCONTRACT AS "crashContract",
			D.FCONTRACTPHONE AS "contractPhone",
			D.FPHOTO AS "photo",
			D.FUSERNAME AS "userName",
			D.FPASSWORD AS "password",
			D.FSTATUS AS "status",
			D.FKPERSONPOSITIONID AS "personPosition.id",
			D.FQQ AS "qq",
			D.FHOUSEHOLD AS "household",
			D.FNOWLIVEPLACE AS "nowLivePlace",
			D.FNATIVEPLACE AS "nativePlace.id",
			D.FFAMILYADDRESS AS "familyAddress",
			D.FFAMILYTEL AS "familyTel",
			D.FFOLK AS "folk.id",
			D.FWEDSTATUS AS "wedStatus",
			D.FWORKYEAR AS "workYear",
			D.FINTEREST AS "interest",
			D.FRECRUITMETHOD AS "recruitmethod",
			D.FRECRUITREMARK AS "recruitRemark",
			D.FKINTRODUCERID AS "introducer.id",
			D.FRELATION AS "relation",
			D.FPERSONSTATUS AS "personStatus",
			D.FJOBSTATUS AS "jobStatus.id",
			D.FLEAVEDATE AS "leaveDate",
			D.FINNERDATE AS "innerDate",
			D.FBANK AS "bank",
			D.FBANKNUMBER AS "bankNumber",
			D.FCOMPUTERNUMBER AS "computerNumber",
			D.FFUNDNUMBER AS "fundNumber",
			D.FHIGHESTEDUCATION AS "highestEducation",
			D.FPERSONALREMARK AS "personalRemark",
			D.FFANSCOUNT AS "fansCount",
			D.FPOSITIONNAME AS "positionName",
			D.FbillStatu as "billStatu",
			D.FKMAINPOSITIONORGID AS "mainPositionOrg.id",
			D.FKMAINPOSITIONID AS "mainPosition.id",
			D.FKMAINJOBLEVELID AS "mainJobLevel.id",
			D.FTITLE AS "title",
			D.fbillNumber as "billNumber",
			p.fname as "mainPosition.name",
			o.fname as "mainPositionOrg.name",
			j.fname as "mainJobLevel.name",
			D.FKAPPLYPERSONID as "applyPerson.id" ,
			D.FPROBATIONPERIOD as "probationPeriod" ,
			D.FPREFIRSTMONTH as "preFirstMonth",
		    D.FPRETWOMONTH as "preTwoMonth",
		    D.FPRETHREEMONTH as "preThreeMonth",
		    D.FRESULTSNOTE as "resultsNote",
		    D.FKREFERRERID AS "referrer.id",
		    RP.FNAME AS "referrer.name",
        	D.FISEFFECTIVE AS "isEffective"
		FROM t_hr_EmployeeOrientation D
		left join T_BD_POSITION P ON D.FKMAINPOSITIONID  = P.FID
		LEFT JOIN T_BD_ORG O ON D.FKMAINPOSITIONORGID = O.FID
		LEFT JOIN T_BD_JOBLEVEL J ON J.FID = D.FKMAINJOBLEVELID
		LEFT JOIN T_BD_PERSON RP ON RP.FID=D.FKREFERRERID
		<where>
			1=1
			<if test="key!=null and key!=''">
			 AND (D.FNAME LIKE '%${key}%' OR D.FNUMBER LIKE '%${key}%' OR   D.fbillNumber  LIKE '%${key}%' 
			 OR J.FNAME LIKE '%${key}%' OR P.FNAME LIKE '%${key}%')
			</if>
			<if test="orgId!=null and orgId!=''"> AND D.FKMAINPOSITIONORGID = #{orgId}</if>
			<if test="notBillId != null" >
		        AND D.FID != #{notBillId,jdbcType=VARCHAR}
		    </if>
			<choose>
				<when test="dateType == 'createType'">
				  <if test="beginDate != null and endDate !=null" >
			        AND (D.FCREATETIME &gt;= #{beginDate} and D.FCREATETIME &lt;= addDate(#{endDate},1))
			      </if>
			      <if test="beginDate != null and endDate ==null " >
			        AND D.FCREATETIME &gt;= #{beginDate}
			      </if>
			      <if test="beginDate == null and endDate !=null " >
			        AND D.FCREATETIME &lt;= addDate(#{endDate},1)
			      </if>
				</when>
				<otherwise>
				   <if test="beginDate != null and endDate !=null" >
			        AND (D.FINNERDATE &gt;= #{beginDate} and D.FINNERDATE &lt;= #{endDate})
			      </if>
			      <if test="beginDate != null and endDate ==null " >
			        AND D.FINNERDATE &gt;= #{beginDate}
			      </if>
			      <if test="beginDate == null and endDate !=null " >
			        AND D.FINNERDATE &lt;= #{endDate}
			      </if>
				</otherwise>
		   </choose>
			<if test="orgLongNumber!=null">
					AND O.FLONGNUMBER LIKE '${orgLongNumber}%'
			</if>
			<if test="applyPersonId !=null and applyPersonId !=''"> AND D.FKAPPLYPERSONID = #{applyPersonId}</if>
			<if test="idCard !=null and idCard !=''"> AND D.FIDCARD = #{idCard}</if>
			<if test="billSta!=null and billSta!=''"> AND D.FBILLSTATU = #{billSta}</if>
			<if test="isEffective !=null"> AND D.FISEFFECTIVE = #{isEffective}</if>
			<if test="innerDate!=null and innerDate!=''"> AND getFormatDate(D.FINNERDATE) &lt;= #{innerDate}</if>
			
			<if test="controlUnitId !=null and controlUnitId!='' ">AND D.FKCONTROLUNITID = #{controlUnitId}</if>
			order by D.FCREATETIME desc
		</where>
	</select>
</mapper>
